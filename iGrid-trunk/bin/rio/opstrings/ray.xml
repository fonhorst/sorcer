<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<!DOCTYPE opstring SYSTEM "java://org/jini/rio/dtd/rio_opstring.dtd" [
    <!ENTITY Local.IP SYSTEM "java://java.net.InetAddress.getLocalHost().getHostAddress()" >
    <!ENTITY Local.Port "9000" >
    <!ENTITY CodeServerURL "http://&Local.IP;:&Local.Port;/" >
    <!ENTITY group SYSTEM "java://java.lang.System.getProperty(user.name)">
]>

<opstring>
            
    <OperationalString Name="Ray Trace">
        
        <Codebase>&CodeServerURL;</Codebase>
    
        <Groups>
	        <!--<Group>&group;</Group>-->
	        <Group>sorcer.DEV</Group>
        </Groups>
        
        <ServiceBean Name="RayTrace Control">
            <Interfaces>
                <Interface>org.jini.rio.examples.raytrace.RayTraceControl</Interface>
                <Resources>
                    <JAR>raytrace-dl.jar</JAR>
                    <JAR>rio-space-dl.jar</JAR>
                    <JAR>rio-dl.jar</JAR>
                </Resources>
            </Interfaces>

            <ImplementationClass>org.jini.rio.examples.raytrace.RayTraceControlImpl
                <Resources>
                    <JAR>raytrace.jar</JAR>
                    <JAR>rio-space.jar</JAR>
                </Resources>
            </ImplementationClass>

            <ServiceLevelAgreements>
                <SystemRequirements>
                    <Utilization ID="System" High=".95" />
                    <Utilization ID="CPU" High=".9" />
                    <Utilization ID="Memory" High=".9" />
                </SystemRequirements>                                
            </ServiceLevelAgreements>

            <Maintain>1</Maintain>

            <Comment>Ray Trace Engine for submitting and getting raytraced images</Comment>

            <Associations>
                <Association Type="requires" 
                             Name="JavaSpace" 
                             OperationalString="Outrigger"/>
                <Association Type="requires" 
                             Name="Space Worker"/>                             
            </Associations>            

            <FaultDetectionHandler 
                ClassName="org.jini.rio.resources.client.StandardFaultDetectionHandler">                
                <Configuration>                    
                    <Component Name="org.jini.rio.resources.client.StandardFaultDetectionHandler">
                        <Parameter Name="LeaseDuration" Value="10000"/>
                        <Parameter Name="RetryCount" Value="2"/>
                        <Parameter Name="RetryTimeout" Value="500"/>
                    </Component>
                </Configuration>
            </FaultDetectionHandler>

        </ServiceBean>

        <ServiceBean Name="Space Worker">            
            <Interfaces>
                <Interface>org.jini.rio.substrates.space.SpaceStation</Interface>
                <Resources>
                    <JAR>rio-space-dl.jar</JAR>
                    <JAR>rio-dl.jar</JAR>                    
                </Resources>
            </Interfaces>
            
            <ImplementationClass>org.jini.rio.substrates.space.SpaceStationImpl
                <Resources>
                    <JAR>rio-space.jar</JAR>
                    <JAR>raytrace-dl.jar</JAR>
                </Resources>
            </ImplementationClass>

            <ServiceLevelAgreements> 
                <SystemRequirements>
                    <Utilization ID="System" High=".9" />
                    <Utilization ID="CPU" High=".9" />
                    <Utilization ID="Memory" High=".9" />
                </SystemRequirements>
                        
                <SLA ID="CPU" Low=".2" High=".9" >
                    <Configuration>
                        <Component Name="org.jini.rio.qos.SLAPolicyHandler">
                            <Parameter Name="slaPolicyHandler" 
                                       Value="new org.jini.rio.qos.ScalingPolicyHandler(
                                                    (org.jini.rio.core.SLA)$data)" />
                        </Component>
                        <Component Name="org.jini.rio.qos.ScalingPolicyHandler">                            
                            <Parameter Name="MaxServices" Value="20" />
                            <Parameter Name="LowerThresholdDampeningFactor" Value="60000" />
                            <Parameter Name="UpperThresholdDampeningFactor" Value="30000" />
                            <Parameter Name="ServiceDiscoveryWait" Value="2000" />
                        </Component>
                    </Configuration>                    
                </SLA>

            </ServiceLevelAgreements>

            <Associations>
                <Association Type="requires" 
                             Name="JavaSpace" 
                             OperationalString="Outrigger"/>
            </Associations>

            <Maintain>1</Maintain>                        
            
            <Configuration>
                <Component Name="org.jini.rio.substrates.space">
                    <Parameter Name="templateClass" 
                               Value="new 
                                  org.jini.rio.examples.raytrace.render.RenderTask()"/>
                </Component>
            </Configuration>
            
            <Parameters>
                <Parameter Name="useWeakHashMap" Value="No"/>                
            </Parameters>            
            
            <Comment>Generic Java Space Worker</Comment>

        </ServiceBean>

        <Include>outrigger.xml</Include>

    </OperationalString>
</opstring>
